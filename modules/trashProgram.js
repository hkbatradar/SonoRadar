import{getTrashFileNames}from"./fileState.js";export function initTrashProgram({buttonId:e="trashProgramBtn",popupId:t="trashProgramPopup",confirmId:o="trashProgramConfirmBtn",cancelId:s="trashProgramCancelBtn"}={}){const n=document.getElementById(e),i=document.getElementById(t),a=document.getElementById(o),l=document.getElementById(s),r=i?.querySelector(".popup-close-btn");function c(){i.style.display="none"}n&&i&&a&&l?(n.addEventListener("click",(function(){0!==getTrashFileNames().length&&(i.style.display="block")})),a.addEventListener("click",(()=>{c(),function(){const e=getTrashFileNames();if(0===e.length)return;const t=[];t.push("@echo off"),t.push("setlocal EnableDelayedExpansion"),t.push(`set COUNT=${e.length}`),t.push(`if not exist "${e[0]}" (`),t.push('  powershell -NoProfile -Command "Add-Type -AssemblyName Microsoft.VisualBasic; [Microsoft.VisualBasic.Interaction]::MsgBox((\\"Cannot find the target .wav files.`nPlease place this batch file in the folder containing the .wav files and try again.\\"),\\"OKOnly,Critical\\",\\"File Not Found\\")"'),t.push("  exit /b"),t.push(")"),t.push("echo Listing !COUNT! .wav file(s) to be deleted:"),e.forEach((e=>{t.push(`echo ${e}`)})),t.push("echo."),t.push('powershell -NoProfile -Command "Add-Type -AssemblyName Microsoft.VisualBasic; $res=[Microsoft.VisualBasic.Interaction]::MsgBox((\\"This will delete !COUNT! wav file(s). Continue?\\"),\\"OkCancel,Exclamation\\",\\"Confirm Delete\\"); if ($res -ne \\"Ok\\") { exit 0 }"'),t.push("set DELETED=0"),t.push("for %%F in ("),e.forEach((e=>{t.push(`"${e}"`)})),t.push(") do ("),t.push('  if exist "%%F" ('),t.push('    del "%%F"'),t.push("    if not errorlevel 1 set /a DELETED+=1"),t.push("  )"),t.push(")"),t.push("echo."),t.push('powershell -NoProfile -Command "Add-Type -AssemblyName Microsoft.VisualBasic; [Microsoft.VisualBasic.Interaction]::MsgBox((\\"Deleted !DELETED! wav file(s).\\"),\\"OKOnly,Information\\",\\"Delete Done\\")"'),t.push("endlocal");const o=new Blob([t.join("\r\n")],{type:"application/octet-stream"}),s=URL.createObjectURL(o),n=document.createElement("a");n.href=s,n.download="delete_trash_files.bat",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)}()})),l.addEventListener("click",c),r?.addEventListener("click",c)):console.warn("[trashProgram] Required elements not found.")}
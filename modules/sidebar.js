import{getFileList,getCurrentIndex}from"./fileState.js";export function initSidebar({onFileSelected:e}={}){const t=document.getElementById("sidebar"),n=document.getElementById("toggleSidebarBtn"),l=(document.getElementById("sidebarIcon"),document.getElementById("fileList")),o=document.getElementById("searchInput"),i=(document.getElementById("currentFilePath"),document.getElementById("fileCount"));function a(t=""){const n=getFileList(),o=getCurrentIndex();if(i){const e=`(Total: ${n.length.toLocaleString()} files)`;i.textContent=e}let a=null;l.innerHTML="",n.forEach(((n,i)=>{if(t&&!n.name.toLowerCase().includes(t))return;const c=document.createElement("li");c.style.padding="3px 0",c.style.cursor="pointer";const d=n.name.replace(/\.wav$/i,""),r=document.createElement("i");r.className="fa-regular fa-file-audio",r.style.marginRight="6px";const s=document.createTextNode(d);c.appendChild(r),c.appendChild(s),c.addEventListener("click",(()=>{"function"==typeof e&&e(i)})),i===o&&(c.style.fontWeight="bold",c.style.color="#007bff",a=c),l.appendChild(c)})),a&&requestAnimationFrame((()=>{a.scrollIntoView({block:"center",behavior:"smooth"})}))}return n.addEventListener("click",(()=>{t.classList.toggle("collapsed");const e=t.classList.contains("collapsed");n.title=e?"Open File List":"Collapse File List"})),o.addEventListener("input",(()=>{a(o.value.trim().toLowerCase())})),{refresh:(e,t=!0)=>{!function(e){document.getElementById("fileNameText").textContent=e||"Upload wav file(s)"}(e),t&&(o.value=""),a(o.value.trim().toLowerCase())}}}
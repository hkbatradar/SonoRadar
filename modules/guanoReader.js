export async function extractGuanoMetadata(t){if(!t)return"(no file selected)";const e=await t.arrayBuffer(),i=new DataView(e),n=new TextDecoder("utf-8");let a=12,o=null;for(;a<i.byteLength;){String.fromCharCode(i.getUint8(a),i.getUint8(a+1),i.getUint8(a+2),i.getUint8(a+3));const t=i.getUint32(a+4,!0),r=new Uint8Array(e,a+8,t),s=n.decode(r);if(s.includes("GUANO|Version:")){o=s;break}a+=8+t,t%2==1&&(a+=1)}return o||"(No GUANO metadata found in file)"}export function parseGuanoMetadata(t){if(!t||t.startsWith("(No GUANO"))return{};const e=t.split(/\r?\n/),i={};e.forEach((t=>{const e=t.indexOf(":");if(-1===e)return;const n=t.slice(0,e).trim(),a=t.slice(e+1).trim();i[n]=a}));const n=i.Timestamp;if(n){const[t,e]=n.split(" "),a=(e||"").split("+")[0];i._Date=t?t.replace(/-/g,"/"):"",i._Time=a?a.slice(0,5).replace(":",""):""}if(i["Loc Position"]){const[t,e]=i["Loc Position"].split(/\s+/);i._Latitude=t||"",i._Longitude=e||""}return{date:i._Date||"",time:i._Time||"",latitude:i._Latitude||"",longitude:i._Longitude||""}}
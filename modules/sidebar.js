import{getFileList,getCurrentIndex}from"./fileState.js";export function initSidebar({onFileSelected:e}={}){const t=document.getElementById("sidebar"),n=document.getElementById("toggleSidebarBtn"),l=(document.getElementById("sidebarIcon"),document.getElementById("fileList")),i=document.getElementById("searchInput");document.getElementById("currentFilePath");function o(t=""){const n=getFileList(),i=getCurrentIndex();let o=null;l.innerHTML="",n.forEach(((n,a)=>{if(t&&!n.name.toLowerCase().includes(t))return;const r=document.createElement("li");r.style.padding="3px 0",r.style.cursor="pointer";const c=n.name.replace(/\.wav$/i,""),d=document.createElement("i");d.className="fa-regular fa-file-audio",d.style.marginRight="6px";const s=document.createTextNode(c);r.appendChild(d),r.appendChild(s),r.addEventListener("click",(()=>{"function"==typeof e&&e(a)})),a===i&&(r.style.fontWeight="bold",r.style.color="#007bff",o=r),l.appendChild(r)})),o&&requestAnimationFrame((()=>{o.scrollIntoView({block:"center",behavior:"smooth"})}))}return n.addEventListener("click",(()=>{t.classList.toggle("collapsed");const e=t.classList.contains("collapsed");n.title=e?"Open File List":"Collapse File List"})),i.addEventListener("input",(()=>{o(i.value.trim().toLowerCase())})),{refresh:(e,t=!0)=>{!function(e){document.getElementById("fileNameText").textContent=e||"Upload wav file(s)"}(e),t&&(i.value=""),o(i.value.trim().toLowerCase())}}}
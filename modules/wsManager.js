import WaveSurfer from"./wavesurfer.esm.js";import Spectrogram from"./spectrogram.esm.js";let ws=null,plugin=null,currentColorMap=null;export function initWavesurfer({container:e,url:r,sampleRate:n=256e3}){return ws=WaveSurfer.create({container:e,height:0,interact:!1,cursorWidth:0,url:r,sampleRate:n}),ws}export function createSpectrogramPlugin({colorMap:e,height:r=800,frequencyMin:n=10,frequencyMax:t=128,noverlap:o=null}){const l={labels:!1,height:r,fftSamples:1024,frequencyMin:1e3*n,frequencyMax:1e3*t,scale:"linear",windowFunc:"hann",colorMap:e};return null!==o&&(l.noverlap=o),Spectrogram.create(l)}export function replacePlugin(e,r=800,n=10,t=128,o=null,l=null){if(!ws)throw new Error("Wavesurfer not initialized.");const u=document.getElementById("spectrogram-only").querySelector("canvas");u&&u.remove(),plugin?.destroy&&plugin.destroy(),currentColorMap=e;const a=null!==o?Math.floor(o/100*1024):null;plugin=createSpectrogramPlugin({colorMap:e,height:r,frequencyMin:n,frequencyMax:t,noverlap:a}),ws.registerPlugin(plugin);try{plugin.render(),requestAnimationFrame((()=>{"function"==typeof l&&l()}))}catch(e){console.warn("⚠️ Spectrogram render failed:",e)}}export function getWavesurfer(){return ws}export function getPlugin(){return plugin}export function getCurrentColorMap(){return currentColorMap}